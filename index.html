
<!DOCTYPE html>
<html>

<head>
    <title>Penguin Crossing</title>
    <style type="text/css">
        canvas { border: 3px solid black; }
    </style>

    <script type="text/javascript">

        // Global variable here
        var ctx;
        var board = new Image();
        var penguin = new Image();
        var fin = new Image();
        var fin2 = new Image();
        var blood = new Image();
        board.src = "images/backdrop2.png";
        penguin.src = "images/penguin.png";
        fin.src = "images/fin.png";
        fin2.src = "images/fin2.png";
        blood.src = "images/blood.png";

        var px = 350;
        var py = 540;
        var px0 = 350;
        var py0 = 540;
        var WIDTH = 800;
        var HEIGHT = 600;
        var interval = 10;
        var canvas;
        var intervalId = 0;
        //First shark
        var fxa = 750;
        var fya = 450;
        //Second shark
        var fxb = 50;
        var fyb = 270;
        //Third shark
        var fxc = 750;
        var fyc = 80;
        var score = 0;


        //Key listeners
        // What to do if the keys are pressed down
        function onKeyDown(evt)
        {
            switch (evt.keyCode)
            {
                case 38:  /* Up arrow was pressed */

                    if( py > 5 )   		// can we go up if yes
                    {
                        py -= 10; // GO UP
                    }
                    break;

                case 40:  /* Down arrow was pressed */
                    if	 (py < canvas.height - 50)  // are we below the floor?
                    {
                        py += 10;  // Go DOWN
                    }
                    break;

                case 37:  /* Left arrow was pressed */
                    if ( px > -20 )
                    {
                        px -= 10; 			// Go LEFT
                    }
                    break;
                case 39:  /* Right arrow was pressed */
                    if (px < canvas.width - 90)
                    {
                        px += 10; // Go RIGHT
                    }
                    break;


            } // end switch
        } // end function



        function init()
        {
            ctx = document.getElementById('canvas').getContext('2d');
            canvas = document.getElementById('canvas');
            //ctx.drawImage(board, 0 , 0);

            WIDTH = ctx.canvas.width; // not with the canvas 'variable'
            HEIGHT = ctx.canvas.height;

            window.addEventListener('keydown',onKeyDown,true);

            // call setInterval to request browser to run function every 10 milliseconds
            setInterval( draw, interval );

        }



        function draw()
        {
            ctx.drawImage(board, 0, 0);
            ctx.drawImage(penguin, px, py);
            ctx.font="20px Georgia";
            ctx.fillText("Score: " + score,10,590);
            shark();
            detect();
            status();
        }

        function shark(){
            //Shark a movement
            var rspeeda = Math.floor(Math.random() * 15) + 1;
            ctx.drawImage(fin, fxa, fya);
            if (fxa < -49) {
                fxa = 800;
            }
            if (fxa > -50) {
                fxa -= rspeeda/2;
            }
            //Shark b movement
            var rspeedb = Math.floor(Math.random() * 15) + 1;
            ctx.drawImage(fin2, fxb, fyb);
            if (fxb >= 800) {
                fxb = -20;
            }
            if (fxb < 800) {
                fxb += rspeedb * .75;
            }
            //Shark c movement
            var rspeedc = Math.floor(Math.random() * 15) + 1;
            ctx.drawImage(fin, fxc, fyc);
            if (fxc < -49) {
                fxc = 800;
            }
            if (fxc > -50) {
                fxc -= rspeeda * .95;
            }
        }

        function detect(){
            if ( ( Math.abs(py - fya) < 50) && (Math.abs(px - fxa) < 50) ){
                ctx.drawImage(blood,px,py);
                ctx.drawImage(penguin, px, py);
                alert("Sorry, you didn't swim fast enough.\nTry again!");
                px = px0;
                py = py0;
                score -= 25;
            }
            if ( ( Math.abs(py - fyb) < 50) && (Math.abs(px - fxb) < 20) ){
                ctx.drawImage(blood,px,py);
                ctx.drawImage(penguin, px, py);
                alert("Sorry, you didn't swim fast enough.\nTry again!");
                px = px0;
                py = py0;
                score -= 25;
            }
            if ( ( Math.abs(py - fyc) < 50) && (Math.abs(px - fxc) < 80) ){
                ctx.drawImage(blood,px,py);
                ctx.drawImage(penguin, px, py);
                alert("Sorry, you didn't swim fast enough.\nTry again!");
                px = px0;
                py = py0;
                score -= 25;
            }
        }

        function status(){
            if (py < 10){
                alert("You made it home, congrats!");
                px = px0;
                py = py0;
                score += 100;
            }

        }


    </script>
</head>

<!-- HERE we add an explicit call to the draw() function -->
<body onload="init()">
<canvas id="canvas" width="800" height="600">
    Your browser does not support the canvas element.
</canvas>
</body>
</html>
